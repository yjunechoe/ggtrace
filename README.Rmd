---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# {ggtrace}

<!-- badges: start -->
`r lifecycle::badge('experimental')`
<!-- badges: end -->

An experimental package for programmatically debugging ggproto methods with `trace()`.

## Installation

You can install the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("yjunechoe/ggtrace")
```

## Usage

```{r setup}
library(ggtrace)
library(ggplot2) # v3.3.5
```

### Example - `compute_layer` method from `PositionJitter`

```{r ex-1-setup}
jitter_plot <- ggplot(diamonds[1:1000,], aes(cut, depth)) +
  geom_point(position = position_jitter(width = 0.2, seed = 2021))
jitter_plot
```

```{r ex-1-ggbody}
ggbody(PositionJitter$compute_layer)
```

```{r ex-1a-ggtrace, fig.show='hide'}
ggtrace(
  method = PositionJitter$compute_layer,
  trace_steps = c(1, 1, 9, 12),
  trace_exprs = rlang::exprs(
    head(data),        # What does the data passed in look like?
    params,            # What do the initial parameters look like?
    head(dummy_data),  # What is `dummy_data` defined at Step 8?
    head(~line)        # What does the last line evaluate to?
                       # - i.e., what is returned by the method?
  )
)

# plot not printed to save space
jitter_plot
```

```{r ex-1a-last}
last_ggtrace()
```

```{r ex-1b-ggtrace, fig.show='hide'}
ggtrace(
  method = PositionJitter$compute_layer,
  trace_steps = c(1, 1, 9, 12),
  trace_exprs = rlang::exprs(
    data,
    params,
    dummy_data,
    ~line
  ),
  .print = FALSE
)

# plot not printed to save space
jitter_plot
```

```{r ex-1b-last}
lapply(last_ggtrace(), head)
```

