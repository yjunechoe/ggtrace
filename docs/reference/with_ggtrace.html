<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="with_ggtrace() provides a functional interface to ggtrace(). It takes a ggplot object
and parameters passed to ggtrace() and returns the immediate tracedump and/or graphical
output without side effects."><title>Generic workflow function which localizes a ggtrace call to a single ggplot object — with_ggtrace • ggtrace</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Atkinson%20Hyperlegible-0.4.0/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Generic workflow function which localizes a ggtrace call to a single ggplot object — with_ggtrace"><meta property="og:description" content="with_ggtrace() provides a functional interface to ggtrace(). It takes a ggplot object
and parameters passed to ggtrace() and returns the immediate tracedump and/or graphical
output without side effects."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ggtrace</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.8.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto"></ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Usage</h6>
    <a class="dropdown-item" href="../articles/intro.html">Introduction to ggtrace()</a>
    <a class="dropdown-item" href="../articles/showcase-ggplot_build.html">Showcase: ggplot build</a>
    <a class="dropdown-item" href="../articles/showcase-aes_evaluation.html">Showcase: aes evaluation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Case Studies</h6>
    <a class="dropdown-item" href="../articles/casestudy-ggxmean.html">Debugging an extension package</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Miscellaneous</h6>
    <a class="dropdown-item" href="../articles/FAQ.html">Frequently asked questions</a>
    <a class="dropdown-item" href="../articles/comparisons.html">Comparison of debugging methods</a>
    <a class="dropdown-item" href="../articles/technical-details.html">Technical details</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/yjunechoe/ggtrace/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Generic workflow function which localizes a ggtrace call to a single ggplot object</h1>
      <small class="dont-index">Source: <a href="https://github.com/yjunechoe/ggtrace/blob/HEAD/R/with_ggtrace.R" class="external-link"><code>R/with_ggtrace.R</code></a></small>
      <div class="d-none name"><code>with_ggtrace.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>with_ggtrace()</code> provides a functional interface to <code><a href="ggtrace.html">ggtrace()</a></code>. It takes a ggplot object
and parameters passed to <code><a href="ggtrace.html">ggtrace()</a></code> and returns the immediate tracedump and/or graphical
output without side effects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">with_ggtrace</span><span class="op">(</span><span class="va">x</span>, <span class="va">method</span>, <span class="va">...</span>, out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tracedump"</span>, <span class="st">"gtable"</span>, <span class="st">"both"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A ggplot object whose evaluation triggers the trace as specified by the <code>...</code></p></dd>
<dt>method</dt>
<dd><p>A function or a ggproto method.
The ggproto method may be specified using any of the following forms:</p><ul><li><p><code>ggproto$method</code></p></li>
<li><p><code>namespace::ggproto$method</code></p></li>
<li><p><code>namespace:::ggproto$method</code></p></li>
</ul></dd>
<dt>...</dt>
<dd><p>Arguments passed on to <code><a href="ggtrace.html">ggtrace</a></code></p><dl><dt><code>trace_steps</code></dt>
<dd><p>A sorted numeric vector of positions in the method's body to trace. Negative indices
reference steps from the last, where <code>-1</code> references the last step in the body.</p></dd>

    <dt><code>trace_exprs</code></dt>
<dd><p>A list of expressions to evaluate at each position specified
in <code>trace_steps</code>. If a single expression is provided, it is recycled to match the length of <code>trace_steps</code>.</p>
<p>To simply run a step and return its output, you can use the <code>~step</code> keyword. If the step
is an assign expression, the value of the assigned variable is returned.
If <code>trace_exprs</code> is not provided, <code><a href="ggtrace.html">ggtrace()</a></code> is called with <code>~step</code> by default.</p></dd>

    <dt><code>once</code></dt>
<dd><p>Whether to <code><a href="https://rdrr.io/r/base/trace.html" class="external-link">untrace()</a></code> the method on exit. If <code>FALSE</code>, creates a persistent trace which is
active until <code><a href="gguntrace.html">gguntrace()</a></code> is called on the method. Defaults to <code>TRUE</code>.</p></dd>

    <dt><code>use_names</code></dt>
<dd><p>Whether the trace dump should use the names from <code>trace_exprs</code>. Defaults to <code>TRUE</code>.</p></dd>

    <dt><code>print_output</code></dt>
<dd><p>Whether to <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> the output of each expression to the console. Defaults to <code>TRUE</code>.</p></dd>

    <dt><code>verbose</code></dt>
<dd><p>Whether logs should be printed when trace is triggered. Encompasses <code>print_output</code>,
meaning that <code>verbose = FALSE</code> also triggers the effect of <code>print_output = FALSE</code> by consequence.
Defaults to <code>FALSE</code>.</p></dd>

  
</dl></dd>
<dt>out</dt>
<dd><p>Whether the function should return the output of triggered traces
("tracedump"), or the resulting graphical object from evaluating the ggplot ("gtable"),
or "both", which returns the tracedump but also renders the resulting plot as a
side effect. Partial matching is supported, so these options could also be specified as
"t", "g", or "b". Defaults to "tracedump".</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list or gtable object of class <code>&lt;ggtrace_highjacked&gt;</code></p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>To trigger evaluation of <code>x</code>, the function <code>ggeval_silent(x)</code> is called internally.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ggtrace.html">ggtrace()</a></code>, <code><a href="ggeval_silent.html">ggeval_silent()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Long-form `ggtrace()` method:</span></span>
<span class="r-in"><span class="va">boxplot_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">diamonds</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">cut</span>, <span class="va">depth</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="ggtrace.html">ggtrace</a></span><span class="op">(</span></span>
<span class="r-in"> method <span class="op">=</span> <span class="va">StatBoxplot</span><span class="op">$</span><span class="va">compute_group</span>,</span>
<span class="r-in"> trace_steps <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, trace_exprs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="op">~</span><span class="va">step</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `StatBoxplot$compute_group` now being traced.</span>
<span class="r-in"><span class="va">boxplot_plot</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Triggering trace on `StatBoxplot$compute_group`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Untracing `StatBoxplot$compute_group` on exit.</span>
<span class="r-plt img"><img src="with_ggtrace-1.png" alt="" width="1094" height="676"></span>
<span class="r-in"><span class="va">first_tracedump</span> <span class="op">&lt;-</span> <span class="fu"><a href="last_ggtrace.html">last_ggtrace</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Short-form functional `with_ggtrace()` method:</span></span>
<span class="r-in"><span class="va">second_tracedump</span> <span class="op">&lt;-</span> <span class="fu">with_ggtrace</span><span class="op">(</span></span>
<span class="r-in">  x <span class="op">=</span> <span class="va">boxplot_plot</span>,</span>
<span class="r-in">  method <span class="op">=</span> <span class="va">StatBoxplot</span><span class="op">$</span><span class="va">compute_group</span>,</span>
<span class="r-in">  trace_steps <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, trace_exprs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="op">~</span><span class="va">step</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">first_tracedump</span>, <span class="va">second_tracedump</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># An example with `out = "gtable"` (or `"g"`)</span></span>
<span class="r-in"><span class="va">grid_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">hp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">am</span> <span class="op">~</span> <span class="va">cyl</span><span class="op">)</span></span>
<span class="r-in"><span class="va">grid_plot</span></span>
<span class="r-plt img"><img src="with_ggtrace-2.png" alt="" width="1094" height="676"></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">outline</span> <span class="op">&lt;-</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.rect.html" class="external-link">rectGrob</a></span><span class="op">(</span></span>
<span class="r-in">  x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">1</span>, height <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">  gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">5</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">with_ggtrace</span><span class="op">(</span></span>
<span class="r-in">  x <span class="op">=</span> <span class="va">grid_plot</span>,</span>
<span class="r-in">  method <span class="op">=</span> <span class="va">Layout</span><span class="op">$</span><span class="va">render</span>,</span>
<span class="r-in">  trace_steps <span class="op">=</span> <span class="fl">5</span>,</span>
<span class="r-in">  trace_exprs <span class="op">=</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/expr.html" class="external-link">expr</a></span><span class="op">(</span><span class="op">{</span></span>
<span class="r-in">    <span class="va">panels</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">panels</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">panel</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">      <span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gTree</a></span><span class="op">(</span>children <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gList</a></span><span class="op">(</span><span class="va">panel</span>, <span class="op">!</span><span class="op">!</span><span class="va">outline</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">    <span class="op">}</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">}</span><span class="op">)</span>,</span>
<span class="r-in">  out <span class="op">=</span> <span class="st">"gtable"</span> <span class="co"># or "g"</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-plt img"><img src="with_ggtrace-3.png" alt="" width="1094" height="676"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># With `once = FALSE` for persistent tracing (still cleaned up after)</span></span>
<span class="r-in"><span class="va">lm_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">lm_plot</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `geom_smooth()` using formula 'y ~ x'</span>
<span class="r-plt img"><img src="with_ggtrace-4.png" alt="" width="1094" height="676"></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">with_ggtrace</span><span class="op">(</span></span>
<span class="r-in">  x <span class="op">=</span> <span class="va">lm_plot</span>,</span>
<span class="r-in">  method <span class="op">=</span> <span class="va">StatSmooth</span><span class="op">$</span><span class="va">compute_group</span>,</span>
<span class="r-in">  trace_steps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span class="r-in">  trace_exprs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">group</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span class="r-in">    coef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $coef</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)           x </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   30.683113   -2.878486 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">with_ggtrace</span><span class="op">(</span></span>
<span class="r-in">  x <span class="op">=</span> <span class="va">lm_plot</span>,</span>
<span class="r-in">  method <span class="op">=</span> <span class="va">StatSmooth</span><span class="op">$</span><span class="va">compute_group</span>,</span>
<span class="r-in">  trace_steps <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">  trace_exprs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">method</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loess"</span>, <span class="st">"lm"</span>, <span class="st">"loess"</span><span class="op">)</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">group</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span class="r-in">  out <span class="op">=</span> <span class="st">"g"</span> <span class="co"># or "gtable"</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-plt img"><img src="with_ggtrace-5.png" alt="" width="1094" height="676"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># `with_ggtrace()` is useful for making calculations that are parasitic</span></span>
<span class="r-in"><span class="co"># on a plot's execution environment.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">square_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">hp</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">square_plot</span></span>
<span class="r-plt img"><img src="with_ggtrace-6.png" alt="" width="1094" height="676"></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">rotation_vp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.7</span>, height <span class="op">=</span> <span class="fl">.7</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">parasitic_evaluations</span> <span class="op">&lt;-</span> <span class="fu">with_ggtrace</span><span class="op">(</span></span>
<span class="r-in">  x <span class="op">=</span> <span class="va">square_plot</span>,</span>
<span class="r-in">  method <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">:::</span><span class="va">ggplot_gtable.ggplot_built</span>,</span>
<span class="r-in">  trace_steps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">13</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span class="r-in">  trace_exprs <span class="op">=</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span></span>
<span class="r-in">    plot_tbl <span class="op">=</span> <span class="va">.plot_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.edit.html" class="external-link">editGrob</a></span><span class="op">(</span><span class="va">plot_table</span>, vp <span class="op">=</span> <span class="op">!</span><span class="op">!</span><span class="va">rotation_vp</span><span class="op">)</span>,</span>
<span class="r-in">    legend   <span class="op">=</span> <span class="va">.legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.edit.html" class="external-link">editGrob</a></span><span class="op">(</span><span class="va">legend_box</span>, vp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.15</span>, y <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">    modified <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gTree</a></span><span class="op">(</span>children <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gList</a></span><span class="op">(</span><span class="va">.plot_table</span>, <span class="va">.legend</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/grid.draw.html" class="external-link">grid.draw</a></span><span class="op">(</span><span class="va">parasitic_evaluations</span><span class="op">$</span><span class="va">modified</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>cannot clip to rotated viewport</span>
<span class="r-plt img"><img src="with_ggtrace-7.png" alt="" width="1094" height="676"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://yjunechoe.github.io" class="external-link">June Choe</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.1.</p>
</div>

    </footer></div>

  

  

  </body></html>

