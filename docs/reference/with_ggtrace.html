<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generic workflow function which localizes a ggtrace call to a single ggplot object — with_ggtrace • ggtrace</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Atkinson_Hyperlegible-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Generic workflow function which localizes a ggtrace call to a single ggplot object — with_ggtrace"><meta name="description" content="with_ggtrace() provides a functional interface to ggtrace(). It takes a ggplot object
and parameters passed to ggtrace() and returns the immediate tracedump and/or graphical
output without side effects."><meta property="og:description" content="with_ggtrace() provides a functional interface to ggtrace(). It takes a ggplot object
and parameters passed to ggtrace() and returns the immediate tracedump and/or graphical
output without side effects."><meta property="og:image" content="https://yjunechoe.github.io/ggtrace/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggtrace</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="external-link nav-link" href="https://yjunechoe.github.io/static/papers/Choe_2022_SublayerGG.pdf">Paper</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Usage</h6></li>
    <li><a class="dropdown-item" href="../articles/examples-gallery.html">Examples gallery</a></li>
    <li><a class="dropdown-item" href="../articles/workflow-functions.html">Workflow functions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Design</h6></li>
    <li><a class="dropdown-item" href="../articles/pedagogical-philosophy.html">Pedagogical Philosophy</a></li>
    <li><a class="dropdown-item" href="../articles/extending-trace.html">Extending trace()</a></li>
    <li><a class="dropdown-item" href="../articles/FAQ.html">Frequently asked questions</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/yjunechoe/ggtrace/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generic workflow function which localizes a ggtrace call to a single ggplot object</h1>
      <small class="dont-index">Source: <a href="https://github.com/yjunechoe/ggtrace/blob/HEAD/R/with_ggtrace.R" class="external-link"><code>R/with_ggtrace.R</code></a></small>
      <div class="d-none name"><code>with_ggtrace.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>with_ggtrace()</code> provides a functional interface to <code><a href="ggtrace.html">ggtrace()</a></code>. It takes a ggplot object
and parameters passed to <code><a href="ggtrace.html">ggtrace()</a></code> and returns the immediate tracedump and/or graphical
output without side effects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">with_ggtrace</span><span class="op">(</span><span class="va">x</span>, <span class="va">method</span>, <span class="va">...</span>, out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tracedump"</span>, <span class="st">"gtable"</span>, <span class="st">"both"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A ggplot object whose evaluation triggers the trace as specified by the <code>...</code></p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A function or a ggproto method.
The ggproto method may be specified using any of the following forms:</p><ul><li><p><code>ggproto$method</code></p></li>
<li><p><code>namespace::ggproto$method</code></p></li>
<li><p><code>namespace:::ggproto$method</code></p></li>
</ul></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed on to <code><a href="ggtrace.html">ggtrace</a></code></p><dl><dt><code>trace_steps</code></dt>
<dd><p>A sorted numeric vector of positions in the method's body to trace. Negative indices
reference steps from the last, where <code>-1</code> references the last step in the body.
Special value <code>"all"</code> traces all steps of the method body.</p></dd>

    <dt><code>trace_exprs</code></dt>
<dd><p>A list of expressions to evaluate at each position specified
in <code>trace_steps</code>. If a single expression is provided, it is recycled to match the length of <code>trace_steps</code>.</p>
<p>To simply run a step and return its output, you can use the <code>~step</code> keyword. If the step
is an assign expression, the value of the assigned variable is returned.
If <code>trace_exprs</code> is not provided, <code><a href="ggtrace.html">ggtrace()</a></code> is called with <code>~step</code> by default.</p></dd>

    <dt><code>once</code></dt>
<dd><p>Whether to <code><a href="https://rdrr.io/r/base/trace.html" class="external-link">untrace()</a></code> the method on exit. If <code>FALSE</code>, creates a persistent trace which is
active until <code><a href="gguntrace.html">gguntrace()</a></code> is called on the method. Defaults to <code>TRUE</code>.</p></dd>

    <dt><code>use_names</code></dt>
<dd><p>Whether the trace dump should use the names from <code>trace_exprs</code>.
If <code>trace_exprs</code> is not specified, whether to use the method steps as names.
Defaults to <code>TRUE</code>.</p></dd>

    <dt><code>print_output</code></dt>
<dd><p>Whether to <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> the output of each expression to the console.
Defaults to <code>TRUE</code>.</p></dd>

    <dt><code>verbose</code></dt>
<dd><p>Whether logs should be printed when trace is triggered. Encompasses <code>print_output</code>,
meaning that <code>verbose = FALSE</code> also triggers the effect of <code>print_output = FALSE</code> by consequence.
Defaults to <code>FALSE</code>.</p></dd>


</dl></dd>


<dt id="arg-out">out<a class="anchor" aria-label="anchor" href="#arg-out"></a></dt>
<dd><p>Whether the function should return the output of triggered traces
("tracedump"), or the resulting graphical object from evaluating the ggplot ("gtable"),
or "both", which returns the tracedump but also renders the resulting plot as a
side effect. Partial matching is supported, so these options could also be specified as
"t", "g", or "b". Defaults to "tracedump".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list or gtable object of class <code>&lt;ggtrace_highjacked&gt;</code></p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>To trigger evaluation of <code>x</code>, the function <code>ggeval_silent(x)</code> is called internally.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ggtrace.html">ggtrace()</a></code>, <code><a href="ggeval_silent.html">ggeval_silent()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Long-form `ggtrace()` method:</span></span></span>
<span class="r-in"><span><span class="va">boxplot_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">diamonds</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">cut</span>, <span class="va">depth</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ggtrace.html">ggtrace</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> method <span class="op">=</span> <span class="va">StatBoxplot</span><span class="op">$</span><span class="va">compute_group</span>,</span></span>
<span class="r-in"><span> trace_steps <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, trace_exprs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="op">~</span><span class="va">step</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `StatBoxplot$compute_group` now being traced.</span>
<span class="r-in"><span><span class="va">boxplot_plot</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Triggering trace on `StatBoxplot$compute_group`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Untracing `StatBoxplot$compute_group` on exit.</span>
<span class="r-plt img"><img src="with_ggtrace-1.png" alt="" width="1094" height="676"></span>
<span class="r-in"><span><span class="va">first_tracedump</span> <span class="op">&lt;-</span> <span class="fu"><a href="last_ggtrace.html">last_ggtrace</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Short-form functional `with_ggtrace()` method:</span></span></span>
<span class="r-in"><span><span class="va">second_tracedump</span> <span class="op">&lt;-</span> <span class="fu">with_ggtrace</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">boxplot_plot</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="va">StatBoxplot</span><span class="op">$</span><span class="va">compute_group</span>,</span></span>
<span class="r-in"><span>  trace_steps <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, trace_exprs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="op">~</span><span class="va">step</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">first_tracedump</span>, <span class="va">second_tracedump</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># An example with `out = "gtable"` (or `"g"`)</span></span></span>
<span class="r-in"><span><span class="va">grid_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">hp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">am</span> <span class="op">~</span> <span class="va">cyl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">grid_plot</span></span></span>
<span class="r-plt img"><img src="with_ggtrace-2.png" alt="" width="1094" height="676"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">outline</span> <span class="op">&lt;-</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.rect.html" class="external-link">rectGrob</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">1</span>, height <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">5</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">with_ggtrace</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">grid_plot</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="va">Layout</span><span class="op">$</span><span class="va">render</span>,</span></span>
<span class="r-in"><span>  trace_steps <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  trace_exprs <span class="op">=</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/expr.html" class="external-link">expr</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">panels</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">panels</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">panel</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gTree</a></span><span class="op">(</span>children <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gList</a></span><span class="op">(</span><span class="va">panel</span>, <span class="op">!</span><span class="op">!</span><span class="va">outline</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  out <span class="op">=</span> <span class="st">"gtable"</span> <span class="co"># or "g"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="with_ggtrace-3.png" alt="" width="1094" height="676"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://yjunechoe.github.io" class="external-link">June Choe</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

